--- 
title: 'TMA4315: Compulsory exercise 2 Logistic regression and Poisson regression'
output:
  pdf_document:
    toc: yes
    toc_depth: '2'
  html_document:
    toc: yes
    toc_depth: 2
    toc_float: yes
date: "`r format(Sys.time(), '%d.%m.%Y')`"
subtitle: 'Group XX: Henrik Syversveen Lie, Mikal Stapnes, Oliver Byhring'
---


```{r setup, include = FALSE}
library(formatR)
showsol <- FALSE
library(knitr)
opts_chunk$set(tidy.opts = list(width.cutoff = 68), tidy = TRUE, warning = FALSE, error = FALSE, message = FALSE, echo = TRUE)
```

# Part 1: Logistic regression

## a)

We let $y_i$ be the number of successfull ascents, and $n_i$ be the total number of attempts (success + fail) of the i'th mountain. We then do binary regression with the logit link to model the probability of success. This gives

1. Model for response: $Y_i \sim \text{Bin}(n_i,\pi_i), \quad \text{for } i = 1,\dots,113$
2. Linear predictor: $\eta_i = {\bf x} _i^T \beta$
3. Link function: $\eta_i = \ln(\frac{\pi_i}{1-\pi_i})$

where $x_i$ is a $p$ dimensional column vector of covariates for observation $i$, and $\beta$ is the vector of regression parameters.

# Part 2: Poisson regression - Eliteserien 2018

## a)
We want to test if the assumption of independence between the goals made by the home and away teams is reasonable. To do this, we first load the data set and make a contingency table of all the results, with the goals of the home team on the rows, and goals of the away team on the columns. We get the following contingency table.
```{r, echo = F, eval = T}
filepath <- "https://www.math.ntnu.no/emner/TMA4315/2018h/eliteserien2018"
eliteserie <- read.table(file = filepath, header = TRUE, colClasses = c("character", 
    "character", "numeric", "numeric"))
contingency = matrix(rep(0,25),nrow = 5, ncol = 5)
rownames(contingency) = c("0","1","2","3","4+")
colnames(contingency) = c("0","1","2","3","4+")

for (i in 1:192){
  if (eliteserie[i,3]<4 & eliteserie[i,4]<4){
    contingency[eliteserie[i,3]+1,eliteserie[i,4]+1] = contingency[eliteserie[i,3]+1,eliteserie[i,4]+1]+1
  }  else if (eliteserie[i,3]<4 & !eliteserie[i,4]<4){
    contingency[eliteserie[i,3]+1,5] = contingency[eliteserie[i,3]+1,5] + 1
  }  else if (!eliteserie[i,3]<4 & eliteserie[i,4]<4){
    contingency[5,eliteserie[i,4]+1] = contingency[5, eliteserie[i,4]+1] + 1
  }  else{
    contingency[5,5] = contingency[5,5] + 1
  }
}
print(contingency)

```

We then want to test if the number of goals for home and away team are independent. We do this by conducting _Pearson's_ $\chi^2$ _test_ on the contingency table. The test poses the following hypotheses
$$H_0: \text{The sampling distributions are independently chi-squared distributed}, \quad H_1: \text{They are not independently chi-squared distributed}.$$

```{r, echo = F, eval = T}
Xsq <- chisq.test(contingency)
print(Xsq)
```
We get a value of $14.146$ for the test statistic, with a corresponding p-value of 0.5871. As this p-value is above any reasonable significance level, we keep the null hypothesis, and confirm that the goals scored by the home and away team are independent.








